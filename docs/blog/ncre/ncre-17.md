# 软件架构风格 <!-- {docsify-ignore-all} -->



### 概述

​    软件体系结构（架构）风格是描述`某一特定应用领域`中系统组织方式的惯用模式。体系结构风格定义一个系统家族，即一个体系结构定义`一个词汇表`和`一组约束`。



- 词汇表中包含一些构件和连接件类型。
- 约束指出系统是如何将这些构件和连接件组合起来。

​    `体系结构风格`反应了领域中众多系统所共有的`结构`和`语义特性`，并指导如何将各个模块和子系统有效地组织称一个完整的系统。



### 经典体系结构风格

#### 数据流风格

1. 批处理：批处理风格的每一步处理都是独立的，并且每一步都是顺序执行的。只有当前一步执行完成，后一步才能开始。`数据必须是完整的`，以整体的方式进行传递，如日志分析、计费程序等。
2. 管道-过滤器：每个构件中有一组输入一组输出，构件读输入数据流，经过内部处理，然后输出数据流。这个过程通常对输入流是增量计算形式完成。所以在输入未被完全消费之前，输出便产生了，如传统的编译期、Unix管道、Web Filter等。

|      |      批处理      | 管道过滤器 |
| :--: | :--------------: | :--------: |
| 数据 |   数据整体传送   |    增量    |
| 粒度 |    构件粒度大    | 构件粒度小 |
| 延迟 | 延迟大，实时性差 |  实时性好  |
| 并发 |      无并发      |   可并发   |



#### 调用返回风格

1. 主程序/子程序：这种风格一般采用单线程，把问题划分成若干处理步骤，主程序的正确性取决于它调用子程序的正确性。
2. 面向对象：数据的表示和它们的相应操作被封装起来，对象的行为体现在其接受和请求的动作中。对象具有封装性，一个对象的改变不会影响其他对象。如面向对象开发语言。
3. 层次：每层为上一层提供服务，使用下一层的服务，只能见到与自己临近的层。在层次结构中修改某一层，只会香营乡与其相邻的上下两层。上层必须知道下层的身份，不能调整层次之间的顺序，如TCP/IP协议。



#### 独立构件风格

事件的触发者并不知道哪些构件会被这些时间影响，相互保持独立。

1. 进程通信：进程间的消息传递的方式可以是点对点，同步，异步，以及远程过程调用。
2. 事件驱动系统：当某个事件触发时，系统自动调用注册了该事件的所有过程。一个事件触发就导致了另一个模块中的过程调用。这也是一种隐式调用，优点是解耦，为软件复用提供了强大的支持，为软件维护和演化带来了方便，其缺点是构件放弃了系统计算的控制。



#### 虚拟机风格

当底层不支持上层时，在两者之间加入一层虚拟机做模拟仿真，消除硬件和软件之间的差异

1. 解释器：解释器通常包含一个解释器工作引擎、一个包含被解释代码的存储区、一个记录解释器引擎工作状态的数据结构、以及一个记录源代码被解释执行进度的数据结构。缺点是执行效率比较低，如JVM。
2. 基于规则的系统：基于规则的系统包括规则集、规则解释器、规则/数据选择器、工作内存。一个用在人工智能领域和DSS中。



#### 仓库风格

1. 数据库系统：构件分为中央共享数据源、独立处理单元。构件控制中央共享数据。如IDE集成开发环境
2. 黑板：黑板系统包括`知识源`、`黑板`、`控制`三个部分。知识源包括若干独立计算的不同单元，提供解决问题的知识。知识源响应黑板的变化，也只修改黑板；黑板是一个全局数据库，包含问题域，解空间的全部状态，是知识源相互作用的唯一媒介；知识源响应是通过黑板状态的变化来控制的。黑板系统通常应用在对于解决问题没有确定性算法的软件中。与语音识别，信号处理。
3. 超文本系统：静态网页。



#### 闭环控制

闭环控制是将过程输出的指定属性维护在一个特定的参考值，将事务处理按成输入、加工、输出、反馈、再输入的一个持续的过程模型。实例，空调的温度自动调节器，巡航系统；闭环控制是根据控制对象输出反馈来进行校正的控制方式，他是在测量出实际与计划发生偏差时，按定额或标准来进行纠正。



#### C2风格

C2体系结构风格可以概括为通过连接件绑定在一起按照一组规则运作的并行构件网络。

C2风格中的系统规则：

1. 系统中的构件和连接件都有一个顶部和一个底部。
2. 构件的顶部连接到某连接件的底部，构件的底部则连接到连接件的顶部。构件和构件之间不允许直接连接。
3. 一个连接件可以和任意数目的其他构件和连接件连接。
4. 当两个连接件进行连接时，必须由其中一个的底部到另一个的顶部。



#### 二层CS架构

二层CS架构为单一服务器且局域网为中心，所以难以扩展至大型企业广域网或Internet；软硬件的组合及集成能力有限；缺点有：

1. 服务器负荷太重，难以管理大量客户机，系统性能容易变坏；
2. 数据安全性不好，客户机可以直接访问数据库服务器，那么客户机上的其他程序也可以访问数据库服务器，从而使数据库安全性受到威胁。



#### 三层CS架构

与二层CS架构相比，三层CS架构增加了一个应用服务器，可以将整个应用逻辑驻留在应用服务器上，而只有表示层存在于客户机上。这种客户机成为瘦客户机。三层CS架构将应用系统分为表示层、功能层和数据层三部分。

表示层：用户接口，检查用户输入的数据，显示输出的数据；

应用层：业务逻辑层，是将具体的业务处理逻辑编入程序中；

数据层：对DBMS的管理和控制；

与二层CS架构相比，三层CS架构优点：

1. 合理的划分三层，使之在逻辑上保持相对独立，是整个系统逻辑结构清晰，提高可扩展性和可维护性；
2. 允许灵活的、有效的选择相应的平台和硬件系统，这些平台有良好的可升级性和开发性；
3. 各层可以独立的并行开发，各层可以选择适合各自系统的开发语言，使之能够高效率的开发、提高性价比，对每层的开发维护也相对容易些；
4. 利用应用层有效的隔离了表示层和数据层，未授权的用户是无法绕个应用层直接访问数据层的，增加了系统安全性；

#### BS架构

BS架构是三层CS架构的一种实现方式，BS架构利用WWW浏览器技术，结合浏览器脚本语言通过浏览器就可以实现复杂的专用软件，解约了开发成本。



### 其他架构风格

#### 轻量架构

SSH、SSM

#### 面向服务架构



#### 微服务架构

##### 概述

​    微服务是一种架构风格，将单体应用划分成一组小的服务，通过服务之间相互协作实现需求，每个服务运行在独立的进程中，服务间采用轻量级协议通信机制协作，每个服务围绕业务能力进行构建，并且能够通过自动化机制独立的部署。

##### 微服务架构优势

1. 通过分解巨大的单体应用为多个服务方法解决了复杂性问题。同时整体的并发又得到了提升。
2. 让每个服务可以独立开发，开发这可以根据场景选择适合自己服务的技术。
3. 微服务独立部署，加快部署速度。
4. 微服务使得每个服务独立扩展，可以把服务调整服务部署规模已满足业务体量需求，甚至可以单独为微服务定制合适的资源需求。

##### 微服务架构的挑战

1. 并非所有系统都能转成微服务；
2. 微服务架构的部署较单体架构更为复杂；
3. 性能相比单体服务会有所下降，因为一个业务请求可能需要多个微服务通过RPC调用，中间肯定会有网络损耗影响性能；
4. 数据一致性问题，微服务架构每个服务数据库也独立，所以在保证数据一致性方面更加困难。

